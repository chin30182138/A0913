<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>職場關係分析工具</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .section { margin-bottom: 20px; }
        select, button { padding: 10px; margin: 5px 0; }
        .radar-chart { width: 400px; height: 400px; margin: 20px auto; }
        #result { margin-top: 20px; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script>
        const liqinOptions = ['兄弟', '子孫', '妻財', '官鬼', '父母'];
        const liushouOptions = ['青龍', '朱雀', '勾陳', '螣蛇', '白虎', '玄武'];

        // 地支與五行對應
        const dizhiFiveElements = {
            '子': '水', '丑': '土', '寅': '木', '卯': '木', '辰': '土',
            '巳': '火', '午': '火', '未': '土', '申': '金', '酉': '金',
            '戌': '土', '亥': '水'
        };

        // 五行生剋關係
        const fiveElementsCycle = {
            '生': { '木': '火', '火': '土', '土': '金', '金': '水', '水': '木' },
            '剋': { '木': '土', '土': '水', '水': '火', '火': '金', '金': '木' }
        };

        function updateOptions(person, otherPersonPrefix) {
            const liqinSelect = document.getElementById(`${person}-liqin`);
            const liushouSelect = document.getElementById(`${person}-liushou`);
            const otherLiqin = document.getElementById(`${otherPersonPrefix}-liqin`).value || '';
            const otherLiushou = document.getElementById(`${otherPersonPrefix}-liushou`).value || '';

            liqinSelect.innerHTML = '';
            liushouSelect.innerHTML = '';
            liqinOptions.forEach(option => {
                if (option !== otherLiqin) {
                    const opt = document.createElement('option');
                    opt.value = option;
                    opt.text = option;
                    liqinSelect.appendChild(opt);
                }
            });
            liushouOptions.forEach(option => {
                if (option !== otherLiushou) {
                    const opt = document.createElement('option');
                    opt.value = option;
                    opt.text = option;
                    liushouSelect.appendChild(opt);
                }
            });
        }

        function initializeSelects() {
            updateOptions('person1', 'person2');
            updateOptions('person2', 'person1');
        }

        function analyzeRelationship() {
            const person1Liqin = document.getElementById('person1-liqin').value;
            const person1Liushou = document.getElementById('person1-liushou').value;
            const person1Dizhi = document.getElementById('person1-dizhi').value;
            const person2Liqin = document.getElementById('person2-liqin').value;
            const person2Liushou = document.getElementById('person2-liushou').value;
            const person2Dizhi = document.getElementById('person2-dizhi').value;

            // 初始分數
            let compatibility = 50, trust = 50, pace = 50, innovation = 50, communication = 50;

            // 甲方個性影響 (六獸 + 地支)
            if (person1Liushou === '青龍') innovation += 10; // 增創新
            if (person1Liushou === '朱雀') communication += 10; // 增溝通
            if (person1Liushou === '白虎') pace += 10; // 增節奏
            if (person1Liushou === '螣蛇') { innovation += 10; trust -= 5; } // 增創新，減信任
            if (person1Liushou === '玄武') trust -= 10; // 減信任
            if (person1Dizhi === '寅') { innovation += 10; pace += 5; } // 虎：領導力
            if (person1Dizhi === '子') trust += 5; // 鼠：謹慎增信任
            if (person1Dizhi === '午') { pace += 10; communication -= 5; } // 馬：快但衝動

            // 乙方個性影響
            if (person2Liushou === '青龍') innovation += 10;
            if (person2Liushou === '朱雀') communication += 10;
            if (person2Liushou === '白虎') pace += 10;
            if (person2Liushou === '螣蛇') { innovation += 10; trust -= 5; }
            if (person2Liushou === '玄武') trust -= 10;
            if (person2Dizhi === '寅') { innovation += 10; pace += 5; }
            if (person2Dizhi === '子') trust += 5;
            if (person2Dizhi === '午') { pace += 10; communication -= 5; }

            // 雙方互動影響 (六獸 + 地支五行)
            if ((person1Liushou === '青龍' && person2Liushou === '白虎') ||
                (person1Liushou === '白虎' && person2Liushou === '青龍')) {
                pace += 15; communication -= 5; // 青龍+白虎：節奏快，溝通易衝
            }
            if (person1Liqin === '兄弟' && person2Liqin === '子孫') {
                compatibility += 10; trust += 5; // 兄弟+子孫：相容性高
            }

            // 五行生剋影響
            const p1Element = dizhiFiveElements[person1Dizhi];
            const p2Element = dizhiFiveElements[person2Dizhi];
            if (fiveElementsCycle['生'][p1Element] === p2Element) {
                compatibility += 10; communication += 5; // 甲生乙，增相容與溝通
            } else if (fiveElementsCycle['剋'][p1Element] === p2Element) {
                trust -= 10; pace -= 5; // 甲剋乙，減信任與節奏
            } else if (fiveElementsCycle['剋'][p2Element] === p1Element) {
                trust -= 10; pace -= 5; // 乙剋甲，同上
            }

            // 限制分數範圍 0-100
            [compatibility, trust, pace, innovation, communication] = 
                [compatibility, trust, pace, innovation, communication].map(v => Math.min(100, Math.max(0, v)));

            // 顯示分析結果
            document.getElementById('result').innerText = `分析結果：\n- 雙方信息：\n  甲方: ${person1Liqin}, ${person1Liushou}, ${person1Dizhi} (${p1Element})\n  乙方: ${person2Liqin}, ${person2Liushou}, ${person2Dizhi} (${p2Element})\n- 職場關係評估:\n  - 相容性: ${compatibility}\n  - 信任度: ${trust}\n  - 節奏配合: ${pace}\n  - 創新能力: ${innovation}\n  - 溝通效率: ${communication}`;

            // 繪製雷達圖
            const ctx = document.getElementById('radarChart').getContext('2d');
            if (window.myChart) window.myChart.destroy();
            window.myChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['相容性', '信任度', '節奏配合', '創新能力', '溝通效率'],
                    datasets: [{
                        label: '職場關係',
                        data: [compatibility, trust, pace, innovation, communication],
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    scales: { r: { beginAtZero: true, max: 100 } }
                }
            });
        }

        document.querySelectorAll('select').forEach(select => {
            select.addEventListener('change', () => {
                updateOptions(select.id.startsWith('person1') ? 'person1' : 'person2', select.id.startsWith('person1') ? 'person2' : 'person1');
            });
        });

        window.onload = initializeSelects;
    </script>
</head>
<body>
    <div class="container">
        <h2>職場關係分析工具</h2>
        
        <div class="section">
            <h3>第一方信息</h3>
            <select id="person1-liqin"></select>
            <select id="person1-liushou"></select>
            <select id="person1-dizhi">
                <option value="子">子</option><option value="丑">丑</option><option value="寅">寅</option>
                <option value="卯">卯</option><option value="辰">辰</option><option value="巳">巳</option>
                <option value="午">午</option><option value="未">未</option><option value="申">申</option>
                <option value="酉">酉</option><option value="戌">戌</option><option value="亥">亥</option>
            </select>
        </div>

        <div class="section">
            <h3>第二方信息</h3>
            <select id="person2-liqin"></select>
            <select id="person2-liushou"></select>
            <select id="person2-dizhi">
                <option value="子">子</option><option value="丑">丑</option><option value="寅">寅</option>
                <option value="卯">卯</option><option value="辰">辰</option><option value="巳">巳</option>
                <option value="午">午</option><option value="未">未</option><option value="申">申</option>
                <option value="酉">酉</option><option value="戌">戌</option><option value="亥">亥</option>
            </select>
        </div>

        <button onclick="analyzeRelationship()">開始分析</button>
        <canvas id="radarChart" class="radar-chart"></canvas>
        <div id="result"></div>
    </div>
</body>
</html>
